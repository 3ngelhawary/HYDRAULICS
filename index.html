<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Hydraulic Pipe Calculator | Diameter, Velocity, Headloss</title>
  <link rel="stylesheet" href="css/style.css">
</head>
<body>
  <header class="topbar">
    <div class="wrap topbar__inner">
      <div class="brand">
        <div class="brand__logo" aria-hidden="true">H</div>
        <div class="brand__text">
          <div class="brand__name">Hydraulic Pipe Calculator</div>
          <div class="brand__sub">Pressure & Gravity (Manning) • Diameter • Velocity • Headloss • d/D • Pump Head</div>
        </div>
      </div>
      <a class="chip" href="#calc">Online Calculator</a>
    </div>
  </header>

  <main class="wrap">
    <section class="hero">
      <div class="hero__left">
        <h1>Hydraulic Pipe Calculator</h1>
        <p class="muted">
          Enter <b>Total Flow</b> and number of <b>parallel pipes</b>. The calculator uses
          <b>Flow per pipe = Total Flow / No. of pipes</b>.
        </p>

        <div class="hero__badges">
          <div class="badge">
            <div class="badge__k">Pressure</div>
            <div class="badge__v">Friction + Minor + Static</div>
          </div>
          <div class="badge">
            <div class="badge__k">Gravity</div>
            <div class="badge__v">Manning + d/D (%)</div>
          </div>
          <div class="badge">
            <div class="badge__k">Output</div>
            <div class="badge__v">Required Pump Head</div>
          </div>
        </div>
      </div>

      <div class="hero__right">
        <div class="meter">
          <div class="meter__top">
            <div class="meter__title">Live Result</div>
            <div class="meter__pill" id="modePill">Pressure</div>
          </div>
          <div class="meter__value">
            <div class="meter__big" id="bigNumber">—</div>
            <div class="meter__unit" id="bigUnit">—</div>
          </div>
          <div class="meter__bar" aria-hidden="true">
            <div class="meter__fill" id="meterFill"></div>
          </div>
          <div class="meter__hint muted" id="meterHint">Enter inputs to see results.</div>
        </div>
      </div>
    </section>

    <section id="calc" class="panel">
      <div class="panel__tabs" role="tablist" aria-label="Calculator mode">
        <button class="tab is-active" data-tab="pressure" role="tab" aria-selected="true">Pressure Pipe</button>
        <button class="tab" data-tab="gravity" role="tab" aria-selected="false">Gravity Pipe (Manning)</button>
      </div>

      <!-- PRESSURE -->
      <div class="tabpane is-active" id="tab-pressure" data-pane="pressure" role="tabpanel">
        <div class="grid3">
          <div class="card">
            <div class="card__title">Inputs</div>

            <div class="field">
              <label>Number of Pipes (parallel)</label>
              <input id="pCount" type="number" step="1" min="1" value="1" />
              <div class="help muted">Per-pipe flow = Total / Pipes. Pump head equals branch headloss (parallel).</div>
            </div>

            <div class="field">
              <label>Flow (Total)</label>
              <div class="row">
                <input id="qVal" type="number" step="any" placeholder="e.g. 45" />
                <select id="qUnit">
                  <option value="Lps">L/s</option>
                  <option value="m3ps">m³/s</option>
                  <option value="Lpm">L/min</option>
                  <option value="m3ph">m³/h</option>
                  <option value="gpm">gpm (US)</option>
                  <option value="cfs">cfs</option>
                </select>
              </div>
            </div>

            <div class="field">
              <label>Calculation</label>
              <select id="pressureMode">
                <option value="D_from_V">Find Diameter from Target Velocity</option>
                <option value="V_from_D">Find Velocity from Diameter</option>
              </select>
            </div>

            <div class="field" id="targetVWrap">
              <label>Target Velocity</label>
              <div class="row">
                <input id="vTarget" type="number" step="any" placeholder="e.g. 1.5" />
                <select id="vUnit">
                  <option value="mps">m/s</option>
                  <option value="ftps">ft/s</option>
                </select>
              </div>
            </div>

            <div class="field" id="diamWrap" style="display:none;">
              <label>Diameter</label>
              <div class="row">
                <input id="dVal" type="number" step="any" placeholder="e.g. 250" />
                <select id="dUnit">
                  <option value="mm">mm</option>
                  <option value="in">in</option>
                  <option value="m">m</option>
                </select>
              </div>
            </div>

            <div class="field">
              <label>Pipe Length (each pipe)</label>
              <div class="row">
                <input id="pLen" type="number" step="any" value="1000" />
                <select id="pLenUnit">
                  <option value="m">m</option>
                  <option value="km">km</option>
                  <option value="ft">ft</option>
                </select>
              </div>
            </div>

            <div class="field">
              <label>Hazen–Williams C</label>
              <input id="hwC" type="number" step="any" value="130" />
            </div>

            <div class="field">
              <label>Minor Losses</label>
              <div class="toggleRow">
                <label class="radio">
                  <input type="radio" name="minorMode" id="minorPctMode" checked>
                  <span>Percent of friction</span>
                </label>
                <label class="radio">
                  <input type="radio" name="minorMode" id="minorKMode">
                  <span>Fittings & Valves (K)</span>
                </label>
              </div>

              <div id="minorPctWrap" class="subcard">
                <div class="row">
                  <input id="minorPct" type="number" step="any" value="10" />
                  <select id="minorPctUnit">
                    <option value="percent">%</option>
                  </select>
                </div>
                <div class="help muted">Typical 10–15% (user input).</div>
              </div>

              <div id="minorKWrap" class="subcard" style="display:none;">
                <button class="btn btn--ghost" id="btnEditK" type="button">Edit fittings / valves</button>
                <div class="help muted">Minor head = ΣK · V²/(2g). K table is editable.</div>
              </div>
            </div>

            <div class="field">
              <label>Static Head</label>
              <div class="toggleRow">
                <label class="radio">
                  <input type="radio" name="staticMode" id="staticFixedMode" checked>
                  <span>Fixed</span>
                </label>
                <label class="radio">
                  <input type="radio" name="staticMode" id="staticAutoMode">
                  <span>Auto (levels)</span>
                </label>
              </div>

              <div id="staticFixedWrap" class="subcard">
                <div class="row">
                  <input id="staticFixed" type="number" step="any" value="0" />
                  <select id="staticFixedUnit">
                    <option value="m">m</option>
                    <option value="ft">ft</option>
                  </select>
                </div>
              </div>

              <div id="staticAutoWrap" class="subcard" style="display:none;">
                <div class="field" style="margin-bottom:10px;">
                  <label>Pump axis level</label>
                  <div class="row">
                    <input id="pumpAxis" type="number" step="any" placeholder="e.g. 12.5" />
                    <select id="pumpAxisUnit">
                      <option value="m">m</option>
                      <option value="ft">ft</option>
                    </select>
                  </div>
                </div>
                <div class="field" style="margin-bottom:0;">
                  <label>Max elevation on route</label>
                  <div class="row">
                    <input id="maxElev" type="number" step="any" placeholder="e.g. 34.0" />
                    <select id="maxElevUnit">
                      <option value="m">m</option>
                      <option value="ft">ft</option>
                    </select>
                  </div>
                </div>
                <div class="help muted">Static head = max(0, MaxElev − PumpAxis).</div>
              </div>
            </div>

            <div class="actions">
              <button class="btn" id="btnCalcPressure">Calculate</button>
              <button class="btn btn--ghost" id="btnResetPressure">Reset</button>
            </div>
          </div>

          <div class="card">
            <div class="card__title">Results</div>

            <div class="result">
              <div class="result__label">Diameter</div>
              <div class="result__value" id="resD">—</div>
              <div class="result__sub" id="resDSub">—</div>
            </div>

            <div class="result">
              <div class="result__label">Velocity (per pipe)</div>
              <div class="result__value" id="resV">—</div>
              <div class="result__sub" id="resVSub">—</div>
            </div>

            <div class="result">
              <div class="result__label">Friction Loss hf (each pipe)</div>
              <div class="result__value" id="resHf">—</div>
              <div class="result__sub" id="resHfSub">—</div>
            </div>

            <div class="result">
              <div class="result__label">Minor Loss hm (each pipe)</div>
              <div class="result__value" id="resHm">—</div>
              <div class="result__sub" id="resHmSub">—</div>
            </div>

            <div class="result">
              <div class="result__label">Static Head hs</div>
              <div class="result__value" id="resHs">—</div>
              <div class="result__sub" id="resHsSub">—</div>
            </div>

            <div class="result">
              <div class="result__label">Required Pump Head (TDH)</div>
              <div class="result__value" id="resTDH">—</div>
              <div class="result__sub" id="resTDHSub">hf + hm + hs</div>
            </div>
          </div>

          <div class="card">
            <div class="card__title">Quick Check</div>

            <div class="mini">
              <div class="mini__row">
                <div class="mini__k">Total Q (m³/s)</div>
                <div class="mini__v" id="miniQTot">—</div>
              </div>
              <div class="mini__row">
                <div class="mini__k">Per-pipe Q (m³/s)</div>
                <div class="mini__v" id="miniQ">—</div>
              </div>
              <div class="mini__row">
                <div class="mini__k">Pipes</div>
                <div class="mini__v" id="miniPipes">—</div>
              </div>
              <div class="mini__row">
                <div class="mini__k">ΣK (if K mode)</div>
                <div class="mini__v" id="miniSumK">—</div>
              </div>
            </div>

            <div class="gauge">
              <div class="gauge__top">
                <div class="muted">Velocity Gauge</div>
                <div class="gauge__pill" id="gaugePill">—</div>
              </div>
              <div class="gauge__track" aria-hidden="true">
                <div class="gauge__needle" id="gaugeNeedle"></div>
              </div>
              <div class="gauge__labels muted">
                <span>0</span><span>1</span><span>2</span><span>3</span><span>4+</span>
              </div>
            </div>

            <div class="note muted">
              Parallel pipes: the system headloss equals the headloss of <b>one</b> branch (same start/end nodes).
              Only the flow splits.
            </div>
          </div>
        </div>
      </div>

      <!-- GRAVITY -->
      <div class="tabpane" id="tab-gravity" data-pane="gravity" role="tabpanel">
        <div class="grid3">
          <div class="card">
            <div class="card__title">Inputs</div>

            <div class="field">
              <label>Number of Pipes (parallel)</label>
              <input id="gCount" type="number" step="1" min="1" value="1" />
              <div class="help muted">Per-pipe flow = Total / Pipes.</div>
            </div>

            <div class="field">
              <label>Flow (Total)</label>
              <div class="row">
                <input id="gQVal" type="number" step="any" placeholder="e.g. 120" />
                <select id="gQUnit">
                  <option value="Lps">L/s</option>
                  <option value="m3ps">m³/s</option>
                  <option value="Lpm">L/min</option>
                  <option value="m3ph">m³/h</option>
                  <option value="gpm">gpm (US)</option>
                  <option value="cfs">cfs</option>
                </select>
              </div>
            </div>

            <div class="field">
              <label>Manning n</label>
              <input id="nVal" type="number" step="any" value="0.013" />
            </div>

            <div class="field">
              <label>Slope</label>
              <div class="row">
                <input id="sVal" type="number" step="any" placeholder="e.g. 0.005" />
                <select id="sUnit">
                  <option value="mperm">m/m</option>
                  <option value="percent">%</option>
                  <option value="permil">‰</option>
                </select>
              </div>
            </div>

            <div class="field">
              <label>Calculation</label>
              <select id="gravityMode">
                <option value="DD_from_D">Find d/D (%) from Diameter</option>
                <option value="D_from_Q_at_DD">Find Diameter from Q at d/D (%)</option>
              </select>
            </div>

            <div class="field" id="gDiamWrap">
              <label>Diameter (for d/D calculation)</label>
              <div class="row">
                <input id="gDVal" type="number" step="any" placeholder="e.g. 400" />
                <select id="gDUnit">
                  <option value="mm">mm</option>
                  <option value="in">in</option>
                  <option value="m">m</option>
                </select>
              </div>
            </div>

            <div class="field" id="gDDWrap" style="display:none;">
              <label>d/D (%) for sizing</label>
              <div class="row">
                <input id="gDDVal" type="number" step="any" value="80" />
                <select id="gDDUnit">
                  <option value="percent">%</option>
                </select>
              </div>
            </div>

            <div class="actions">
              <button class="btn" id="btnCalcGravity">Calculate</button>
              <button class="btn btn--ghost" id="btnResetGravity">Reset</button>
            </div>
          </div>

          <div class="card">
            <div class="card__title">Results</div>

            <div class="result">
              <div class="result__label">Diameter</div>
              <div class="result__value" id="gResD">—</div>
              <div class="result__sub" id="gResDSub">—</div>
            </div>

            <div class="result">
              <div class="result__label">Velocity (per pipe)</div>
              <div class="result__value" id="gResV">—</div>
              <div class="result__sub" id="gResVSub">—</div>
            </div>

            <div class="result">
              <div class="result__label">d/D (%)</div>
              <div class="result__value" id="gResDD">—</div>
              <div class="result__sub muted" id="gResDDSub">—</div>
            </div>

            <div class="result">
              <div class="result__label">Full-flow Capacity (same D)</div>
              <div class="result__value" id="gResQfull">—</div>
              <div class="result__sub muted">Manning Q at d/D = 100%</div>
            </div>
          </div>

          <div class="card">
            <div class="card__title">Quick Check</div>

            <div class="mini">
              <div class="mini__row">
                <div class="mini__k">Total Q (m³/s)</div>
                <div class="mini__v" id="gMiniQTot">—</div>
              </div>
              <div class="mini__row">
                <div class="mini__k">Per-pipe Q (m³/s)</div>
                <div class="mini__v" id="gMiniQ">—</div>
              </div>
              <div class="mini__row">
                <div class="mini__k">Pipes</div>
                <div class="mini__v" id="gMiniPipes">—</div>
              </div>
            </div>
          </div>
        </div>
      </div>

    </section>

    <footer class="footer muted">
      <div>© Hydraulic Calculator • Built for fast design checks</div>
    </footer>
  </main>

  <!-- Modal: Fittings & Valves K table -->
  <div class="modal" id="kModal" aria-hidden="true">
    <div class="modal__overlay" id="kModalOverlay"></div>
    <div class="modal__panel" role="dialog" aria-modal="true" aria-label="Fittings and valves K values">
      <div class="modal__head">
        <div>
          <div class="modal__title">Fittings & Valves (K values)</div>
          <div class="modal__sub muted">Edit quantities and K values. Minor head = ΣK · V²/(2g)</div>
        </div>
        <button class="iconbtn" id="kModalClose" type="button" aria-label="Close">✕</button>
      </div>

      <div class="modal__body">
        <table class="ktable" id="kTable">
          <thead>
            <tr>
              <th style="width:46%">Item</th>
              <th style="width:18%">Qty</th>
              <th style="width:18%">K</th>
              <th style="width:18%">K×Qty</th>
            </tr>
          </thead>
          <tbody></tbody>
        </table>

        <div class="modal__sum">
          <div class="pill">ΣK = <span id="sumKText">0</span></div>
          <div class="muted">You can change any K value.</div>
        </div>
      </div>

      <div class="modal__foot">
        <button class="btn btn--ghost" id="kModalReset" type="button">Reset Defaults</button>
        <button class="btn" id="kModalSave" type="button">Save</button>
      </div>
    </div>
  </div>

  <script src="js/app.js"></script>
</body>
</html>
